<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>StreamFind Developer Guide • StreamFind</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="StreamFind Developer Guide">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">StreamFind</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/StreamFind.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/app_guide.html">StreamFind App Guide</a></li>
    <li><a class="dropdown-item" href="../articles/demo_ms_raman_fusion_bsa.html">Comparison of Different Bovine Serum Albumin Products</a></li>
    <li><a class="dropdown-item" href="../articles/demo_ozonation_project.html">Evaluation of Wastewater Ozonation with Mass Spectrometry</a></li>
    <li><a class="dropdown-item" href="../articles/demo_paracetamol_fusion.html">Detection of Quality Deviations in Paracetamol Products</a></li>
    <li><a class="dropdown-item" href="../articles/demo_paracetamol_quantification_mcrals.html">Quantification of Active Product Ingredient in a Pharmaceutical</a></li>
    <li><a class="dropdown-item" href="../articles/developer_guide.html">StreamFind Developer Guide</a></li>
    <li><a class="dropdown-item" href="../articles/general_guide.html">StreamFind General Introduction</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/odea-project/StreamFind/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>StreamFind Developer Guide</h1>
            <h3 data-toc-skip class="subtitle"><div class="line-block">Implementation of processing methods and
algorithms<br><br>
</div></h3>
                        <h4 data-toc-skip class="author">Ricardo
Cunha</h4>
                  <a class="author_email" href="mailto:#"></a><a href="mailto:cunha@iuta.de" class="email">cunha@iuta.de</a>
      
                  
            <h4 data-toc-skip class="date">27 October, 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/odea-project/StreamFind/blob/HEAD/vignettes/articles/developer_guide.Rmd" class="external-link"><code>vignettes/articles/developer_guide.Rmd</code></a></small>
      <div class="d-none name"><code>developer_guide.Rmd</code></div>
    </div>

    
    
<style>
pre {
  overflow-x: auto;
}
pre code {
  word-wrap: normal;
  white-space: pre;
}
</style>
<p><br></p>
<p><br></p>
<hr>
<div class="section level2">
<h2 id="streamfind">StreamFind<a class="anchor" aria-label="anchor" href="#streamfind"></a>
</h2>
<p>The StreamFind is an R package and can be used for data management,
processing, visualization and reporting. This guide uses mass
spectrometry (MS) data as example and aims to instruct developers to
implement new processing modules and additional processing algorithms
for new or existing processing methods in StreamFind.</p>
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<p>The R package is in the <a href="https://github.com/odea-project/StreamFind" class="external-link">StreamFind GitHub
repository</a> of the <a href="https://github.com/odea-project" class="external-link">ODEA
Project</a>. For development, the recommendation is to download the
repository locally using <a href="https://git-scm.com/" class="external-link">git</a> tracking
for version control. The <a href="https://desktop.github.com/" class="external-link">GitHub
desktop</a> tool can be used for more easily install and configure git
with your GitHub account, which is recommended for authoring
contributions. Since it is an R package, the <a href="https://posit.co/products/open-source/rstudio/" class="external-link">RStudio</a> IDE is
recommended for development. Yet, others (e.g., <a href="https://code.visualstudio.com/download" class="external-link">VS Code</a>) will also
work. When using RStudio, the repository can be downloaded via new
project, selecting version control, then git and finally adding the
GitHub <em>url</em> <a href="https://github.com/odea-project/StreamFind" class="external-link uri">https://github.com/odea-project/StreamFind</a>. This should
create a local image of the StreamFind repository directly with git
tracking, if git or GitHub desktop were properly installed and
configured. When using RStudio, the project should directly be
identified as package development where all tools are available to
support development. We recommend setting the <em>Use devtools package
functions if available</em> and <em>generate documentation via
Roxygen</em> (in the configure bottom you select all options) located in
the <em>Build</em> tab under the <em>Configure Build Tools…</em>. For
other IDEs, we recommend using the package <a href="https://www.r-project.org/nosvn/pandoc/devtools.html" class="external-link">devtools</a>.
Considering that the local image of the StreamFind repository is
installed with git tracking, the first step for development is to create
a dedicated branch for implementation of new processing modules and/or
algorithms. The master branch should not be changed directly but
modified by pull requests from the dedicated development branch, giving
the opportunity for code revision.</p>
</div>
<div class="section level3">
<h3 id="structure">Structure<a class="anchor" aria-label="anchor" href="#structure"></a>
</h3>
<p>The streamFind R package is centered around the <a href="https://r6.r-lib.org/index.html" class="external-link">R6</a> class system, which brings
object oriented programming to R. For MS, the <a href="https://odea-project.github.io/StreamFind/reference/MassSpecEngine.html">MassSpecEngine</a>
R6 class is used to encapsulate both the data and methods. The data is
stored in private fields within the <em>MassSpecEngine</em> and can be
accessed and processed via the public methods/fields. Below the creation
of a <em>MassSpecEngine</em> object and the way to access and change
data is briefly shown.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ms</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/MassSpecEngine.html">MassSpecEngine</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print method. Note that MS data files were not yet added!</span></span>
<span><span class="va">ms</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## MassSpecEngine</span></span>
<span><span class="co">## name          NA</span></span>
<span><span class="co">## date          2024-10-27 13:05:00.277705</span></span>
<span><span class="co">## file          NA</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Workflow empty </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## StreamFind::MassSpecAnalyses empty </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results empty</span></span></code></pre>
<p>Under development…</p>
<!-- For implementation of processing methods, the [S7](https://rconsortium.github.io/S7/index.html) class *ProcessingSettings*  -->
<!-- is used to dispatch settings to processing methods. See article [Evaluation of Wastewater Ozonation with Mass Spectrometry](https://odea-project.github.io/StreamFind/articles/demo_ozonation_project.html) for demonstration of usage.  -->
<!-- In essence, a given algorithm to be applied to a processing method is added to the *MassSpecEngine* or to a *Workflow*  -->
<!-- object as a *ProcessingSettings* which is then used to process the data with the defined settings or parameters. The  -->
<!-- structure of a *ProcessingSettings* is exemplified below for the algorithm `openms` to find features in MS data. -->
<!-- ```{r example-settings, results='markup'} -->
<!-- ffs <- MassSpecSettings_FindFeatures_openms() -->
<!-- ffs -->
<!-- ``` -->
<!-- As shown, the constructor of a *ProcessingSettings* is a function always including `[engine name upper cammel case]Settings_[method name upper cammel case]_[algorithm name]`; More details are given in the Semantics (\@ref(semantics)). Then, the *ProcessingSettings* can  -->
<!-- be directly applied to the *MassSpecEngine* or used to assemble an S7 class *Workflow* object. -->
<!-- ```{r add-settings, results='markup'} -->
<!-- workflow <- Workflow(list(ffs)) -->
<!-- workflow -->
<!-- ``` -->
<!-- Alternatively, the *ProcessingSettings* can be saved as a JSON string and imported from a JSON file, as demonstrated below. -->
<!-- ```{r save-settings, results='markup'} -->
<!-- save(ffs, format = "json", name = "ffs") -->
<!-- ``` -->
<!-- ```{r show-json, results='markup'} -->
<!-- jsonlite::prettify(readLines("ffs.json")) -->
<!-- ``` -->
<!-- ```{r import-settings, results='markup'} -->
<!-- ffs <- read(ProcessingSettings(), "ffs.json") -->
<!-- # "openms" replaced by "xcms3_centwave" -->
<!-- ffs -->
<!-- ``` -->
<!-- The use of the S3 object system for *ProcessingSettings* gives flexibility to the list of parameters, meaning that each parameter entry can be a single numeric value, a vector of strings or even a full data.frame if required. Each *ProcessingSettings* constructor (i.e., `[engine name upper cammel case]Settings_[method name upper cammel case]_[algorithm name]`) has a dedicated validation method to ensure that the parameters and metadata are in conformity (as shown below). The validation of a *ProcessingSettings* is always performed before applying it to a processing method. -->
<!-- ```{r validate-settings, results='markup'} -->
<!-- validate(ffs) -->
<!-- ``` -->
<!-- Besides the S3 class *ProcessingSettings*, the *ProcessingSettings* object receives other class names that are used for S3 method dispatchment (i.e., direct the object to the dedicated S3 method where the actual processing algorithm is applied). Below we show the classes of the `ffs` *ProcessingSettings*. The class *patRoon* means that the algorithm `openms` is applied via the package [patRoon](https://github.com/rickhelmus/patRoon). The class *MassSpecSettings_FindFeatures_openms* directs the object to the right processing method and indicates which algorithm to be applied. For this, an [S3 generic](http://adv-r.had.co.nz/S3.html) is used in each processing method (e.g., `MassSpecEngine$find_features()` or `MassSpecEngine$group_features()`) for the dispatchment. This process is not visible to the user but is essential for the developer. Implementation of new processing methods and/or algorithms must consider this structure. In the section Implementation (\@ref(implementation)) the process of adding new methods and algorithms is described in more detail. -->
<!-- ```{r other-classes, results='markup'} -->
<!-- class(ffs) -->
<!-- ``` -->
<!-- ## Semantics -->
<!-- Consistent semantics are attempted within the StreamFind R package. Some of the class and method names were already mentioned above and a clear use of the *underscore* to separate words for methods and use of *Upper Camel Case* for classes is visible. In this section, we try to highlight the defined rules for the most important semantic aspects. All the methods available via the class `MassSpecEngine$` are written with underscore to separate the words (e.g., `get_analysis_names()` or `annotate_features()`). The arguments of methods, functions and class constructors are always written with *Lower Camel Case* when more than one word is needed (e.g., `colorBy` or `minIntensity`). Classes are written with *Upper Camel Case* when two or more words are used (e.g., *MassSpecAnalysis* or *ProjectHeaders*) with the exception of the specific constructor functions for the different algorithm settings, which use the syntax `[engine name]Settings_[method name]_[algorithm name]` (e.g., *MassSpecSettings_FilterFeatures_StreamFind* or *RamanSettings_BinSpectra_StreamFind*); This supports and facilitates the association of the settings with the respective engine and processing method. Functions or methods not available to the user (i.e., not exported via the package NAMESPACE) are written with `.` at the beginning, followed by *underscore* to separate words (e.g., *.get_colors()* or *.plot_spectra_ms2_static()*). This is also applied to the S3 generics of the processing modules, which use the syntax `.s3_[module method]` (e.g., `.s3_FindFeatures` or `.s3_GroupFeatures`). -->
<!-- ## Files -->
<!-- The file structure of the StreamFind package is in line with the [CRAN official package development guideline](https://cran.r-project.org/doc/manuals/R-exts.html#:~:text=Contents%5D%5BIndex%5D-,1.1%20Package%20structure,which%20should%20not%20be%20empty).). All relevant files for the developer are in the R, src, man-roxygen, tests and vignettes. In the R folder are the R scripts, in the src folder are C++ libraries and the [Rcpp](https://cran.r-project.org/web/packages/Rcpp/index.html) interface functions, in the man-roxygen are the templates for documentation of arguments, in the tests are the test units that should be applied for each processing method and each algorithm implementation and finally, in the vignettes are articles, tutorials and guides for the users. R file names in the R folder have a defined name syntax according to the content/function. Class files are named with `class_[class type in capital_[class name].R]`. Exported MS function files are named with `fct_[optional engine associated]_[unique name].R`. Utility functions not exported are named with `utils_[unique name].R`. S3 methods for processing modules are written with `methods_S3_[engine name]_[method name]_[algorithm].R`. *ProcessingSettings* constructors for a given engine are placed in a file named `class_S3_[engine name]Settings.R`. -->
<!-- # Implementation -->
<!-- The implementation of new processing methods and new algorithms for a given processing method differs in terms of impact change. While addition of new processing methods require the change of the main *MassSpecEngine* class and addition of new S3 generics, adding new algorithms for existing modules do not require changes in the existing files. Therefore, we describe their implementation in two separate sections. -->
<!-- ## New methods -->
<!-- Under definition. -->
<!-- ## New algorithms -->
<!-- Under definition. -->
<!-- # ```{r remove-ffs, include=FALSE} -->
<!-- # file.remove("ffs.json") -->
<!-- # ``` -->
<hr>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ricardo Cunha.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
